# Homelab v1.0.0 Configuration
# This file is sourced by homelab.sh - use bash syntax

# =============================================================================
# PATHS
# =============================================================================

# Log directory
HOMELAB_LOG_DIR="/Users/adrian/repos/scripts/homelab-logs"

# Maximum log age in days (older logs auto-deleted)
HOMELAB_MAX_LOG_AGE_DAYS=90

# =============================================================================
# SCRIPT PATHS
# =============================================================================
# Leave empty for auto-detection, or specify custom paths
# Auto-detection searches:
#   1. Explicit config path (below)
#   2. Same directory as homelab.sh
#   3. $HOME/bin/
#   4. /usr/local/bin/
#   5. /opt/homelab/
#   6. $PATH

HOMELAB_DISK_CLEANUP=""
HOMELAB_SSH_AUDIT=""
HOMELAB_NMAP_SCAN=""
HOMELAB_RCLONE_SYNC=""
HOMELAB_UPDATE_ALL=""
HOMELAB_SMART_CLEANUP=""

# Example custom paths:
# HOMELAB_DISK_CLEANUP="/custom/path/disk-cleanup.sh"
# HOMELAB_SSH_AUDIT="/opt/scripts/ssh-key-audit.sh"

# =============================================================================
# DISPLAY OPTIONS
# =============================================================================

HOMELAB_COLOR=true
HOMELAB_VERBOSE=false

# =============================================================================
# WORKFLOW DEFAULTS
# =============================================================================

# Morning Routine
MORNING_SSH_AUDIT_OPTS="--all-users --risk"
MORNING_NMAP_OPTS="--delta"
MORNING_UPDATE_OPTS="--dry-run"

# Weekly Maintenance
WEEKLY_CLEANUP_OPTS="--smart-gc --clean-venvs --venv-age 60"
WEEKLY_SSH_AUDIT_OPTS="--all-users --risk-detail"
WEEKLY_NMAP_OPTS="--full --delta"
WEEKLY_UPDATE_OPTS=""

# Emergency Cleanup
EMERGENCY_DISK_THRESHOLD_GB=10
EMERGENCY_CLEANUP_OPTS="--full-gc --clean-venvs --venv-age 30 -y"

# Pre-Deploy Checks
PREDEPLOY_FAIL_ON_RISK="high"
PREDEPLOY_MIN_DISK_GB=10

# =============================================================================
# SCHEDULING (Phase 2.1)
# =============================================================================

# Automated workflow scheduling
# For cron (Linux): Standard cron format (min hour day month weekday)
# For launchd (macOS): Separate hour/minute settings below

# Cron format (Linux)
HOMELAB_SCHEDULE_MORNING="0 8 * * *"    # Daily at 8:00 AM
HOMELAB_SCHEDULE_WEEKLY="0 2 * * 0"     # Sundays at 2:00 AM

# Launchd format (macOS)
HOMELAB_SCHEDULE_MORNING_HOUR=8
HOMELAB_SCHEDULE_MORNING_MINUTE=0
HOMELAB_SCHEDULE_WEEKLY_HOUR=2
HOMELAB_SCHEDULE_WEEKLY_MINUTE=0
HOMELAB_SCHEDULE_WEEKLY_WEEKDAY=0       # 0=Sunday, 1=Monday, ... 6=Saturday

# =============================================================================
# NOTIFICATIONS (Phase 2.2)
# =============================================================================

# Enable/disable notification system
HOMELAB_NOTIFY_ENABLED=false

# Notification channels (comma-separated: slack,webhook,macos,linux,email)
# Priority order: slack/webhook (primary), macos/linux (secondary), email (fallback)
HOMELAB_NOTIFY_CHANNELS="slack,macos"

# Notification triggers (comma-separated: success,warning,failure,start)
# Default: Only notify on warnings and failures
# Note: 'start' trigger has known edge case with rate limiting - see below
HOMELAB_NOTIFY_TRIGGERS="warning,failure"

# Manual run notifications (require explicit --notify flag)
HOMELAB_NOTIFY_MANUAL=false

# Rich formatting (colors, fields) when supported by channel
HOMELAB_NOTIFY_RICH_FORMAT=true

# Redact paths in notifications (replace $HOME with ~)
HOMELAB_NOTIFY_REDACT_PATHS=false

# Rate limiting: Minimum seconds between notifications (prevent spam)
# Known edge case: Start notifications don't CONSUME the rate limit (allowing
# immediate completion notifications), but they are still SUBJECT TO rate limiting.
# Impact:
#   - Intra-workflow: start → completion works correctly
#   - Cross-workflow: completion → start may be blocked if < 60s apart
# Example: Morning completes at 08:00:00, Weekly starts at 08:00:30 → blocked
# Workaround: Reduce interval or disable 'start' trigger for frequent workflows
HOMELAB_NOTIFY_MIN_INTERVAL_SECONDS=60

# -----------------------------------------------------------------------------
# Slack Webhook Configuration
# -----------------------------------------------------------------------------
# Get webhook URL from: https://api.slack.com/messaging/webhooks
HOMELAB_NOTIFY_SLACK_WEBHOOK_URL=""
HOMELAB_NOTIFY_SLACK_USERNAME="homelab-bot"

# Example:
# HOMELAB_NOTIFY_SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# -----------------------------------------------------------------------------
# Generic Webhook Configuration
# -----------------------------------------------------------------------------
# For Discord, Microsoft Teams, or custom endpoints
# Sends JSON payload with workflow status
HOMELAB_NOTIFY_WEBHOOK_URL=""

# Optional custom headers (one per line, e.g., "Authorization: Bearer token")
HOMELAB_NOTIFY_WEBHOOK_HEADERS=""

# Example (Discord):
# HOMELAB_NOTIFY_WEBHOOK_URL="https://discord.com/api/webhooks/YOUR/WEBHOOK"

# Example (Custom with auth):
# HOMELAB_NOTIFY_WEBHOOK_URL="https://your-server.com/api/notifications"
# HOMELAB_NOTIFY_WEBHOOK_HEADERS="Authorization: Bearer your-token"

# -----------------------------------------------------------------------------
# macOS Native Notifications
# -----------------------------------------------------------------------------
# Requires GUI session (won't work over SSH)
HOMELAB_NOTIFY_MACOS_SOUND=true

# -----------------------------------------------------------------------------
# Email Notifications
# -----------------------------------------------------------------------------
# Requires 'mail' command or SMTP configuration
HOMELAB_NOTIFY_EMAIL_TO=""
HOMELAB_NOTIFY_EMAIL_FROM="homelab@localhost"

# Example:
# HOMELAB_NOTIFY_EMAIL_TO="admin@example.com"

# SMTP configuration (optional, for advanced email setup)
# HOMELAB_NOTIFY_EMAIL_SMTP_HOST=""
# HOMELAB_NOTIFY_EMAIL_SMTP_PORT=587
# HOMELAB_NOTIFY_EMAIL_SMTP_USER=""
# HOMELAB_NOTIFY_EMAIL_SMTP_PASS=""  # Warning: Stored in plaintext

# =============================================================================
# FUTURE FEATURES (Phase 2.3+)
# =============================================================================

# Custom workflow schedules
# HOMELAB_CUSTOM_WORKFLOWS=""
